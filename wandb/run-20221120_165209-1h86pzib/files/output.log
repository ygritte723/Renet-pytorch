manual seed: 1
manual seed: 1
  0%|                                                                                                     | 0/75 [00:00<?, ?it/s]
DataParallel(
  (module): RENet(
    (encoder): ResNet(
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): LeakyReLU(negative_slope=0.1)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn3): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
          (downsample): Sequential(
            (0): Conv2d(3, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): LeakyReLU(negative_slope=0.1)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn3): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
          (downsample): Sequential(
            (0): Conv2d(64, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): LeakyReLU(negative_slope=0.1)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn3): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
          (downsample): Sequential(
            (0): Conv2d(160, 320, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): LeakyReLU(negative_slope=0.1)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn3): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
          (downsample): Sequential(
            (0): Conv2d(320, 640, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
      )
    )
    (fc): Linear(in_features=640, out_features=16, bias=True)
    (scr_module): Sequential(
      (0): SelfCorrelationComputation(
        (unfold): Unfold(kernel_size=(5, 5), dilation=1, padding=2, stride=1)
        (relu): ReLU(inplace=True)
      )
      (1): SCR(
        (conv1x1_in): Sequential(
          (0): Conv2d(640, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (conv1): Sequential(
          (0): Conv3d(64, 64, kernel_size=(1, 3, 3), stride=(1, 1, 1), bias=False)
          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (conv2): Sequential(
          (0): Conv3d(64, 64, kernel_size=(1, 3, 3), stride=(1, 1, 1), bias=False)
          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (2): ReLU(inplace=True)
        )
        (conv1x1_out): Sequential(
          (0): Conv2d(64, 640, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
    )
    (cca_module): CCA(
      (conv): Sequential(
        (0): SepConv4d(
          (proj): Sequential(
            (0): Conv2d(1, 16, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (conv1): Sequential(
            (0): Conv3d(1, 1, kernel_size=(1, 3, 3), stride=(1, 1, 1), padding=(0, 1, 1), bias=False)
            (1): BatchNorm3d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (conv2): Sequential(
            (0): Conv3d(1, 1, kernel_size=(3, 3, 1), stride=(1, 1, 1), padding=(1, 1, 0), bias=False)
            (1): BatchNorm3d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (relu): ReLU(inplace=True)
        )
        (1): ReLU(inplace=True)
        (2): SepConv4d(
          (proj): Sequential(
            (0): Conv2d(16, 1, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (conv1): Sequential(
            (0): Conv3d(16, 16, kernel_size=(1, 3, 3), stride=(1, 1, 1), padding=(0, 1, 1), bias=False)
            (1): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (conv2): Sequential(
            (0): Conv3d(16, 16, kernel_size=(3, 3, 1), stride=(1, 1, 1), padding=(1, 1, 0), bias=False)
            (1): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (relu): ReLU(inplace=True)
        )
      )
    )
    (cca_1x1): Sequential(
      (0): Conv2d(640, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
  )
)















[train] epo:  1 | avg.loss:5.2792 | avg.acc:48.196 (curr:58.667): 100%|██████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
[ log ] *********A better model is found (48.196) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.52 h left














[train] epo:  2 | avg.loss:4.4755 | avg.acc:55.573 (curr:46.667): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.43it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (55.573) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  3 | avg.loss:3.9852 | avg.acc:58.898 (curr:80.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (58.898) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  4 | avg.loss:3.6347 | avg.acc:63.733 (curr:62.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (63.733) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  5 | avg.loss:3.3811 | avg.acc:67.769 (curr:50.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (67.769) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  6 | avg.loss:3.1774 | avg.acc:68.302 (curr:72.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (68.302) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  7 | avg.loss:2.9732 | avg.acc:72.018 (curr:84.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (72.018) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  8 | avg.loss:2.8696 | avg.acc:71.413 (curr:60.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.41it/s]
[train] epo:  9 | avg.loss:2.6588 | avg.acc:74.667 (curr:74.667):   0%|                                              | 0/75 [00:01<?, ?it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo:  9 | avg.loss:2.6982 | avg.acc:74.276 (curr:68.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (74.276) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo: 10 | avg.loss:2.5555 | avg.acc:74.738 (curr:85.333): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.38it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (74.738) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo: 11 | avg.loss:2.5092 | avg.acc:76.160 (curr:76.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] *********A better model is found (76.160) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo: 12 | avg.loss:2.4018 | avg.acc:76.462 (curr:78.667):  99%|████████████████████████████████████▌| 74/75 [00:30<00:00,  2.54it/s]
[ log ] *********A better model is found (76.462) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 12 | avg.loss:2.4018 | avg.acc:76.462 (curr:78.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]















[train] epo: 13 | avg.loss:2.2698 | avg.acc:78.507 (curr:78.667): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.54it/s]
[ log ] *********A better model is found (78.507) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 13 | avg.loss:2.2698 | avg.acc:78.507 (curr:78.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.41it/s]















[train] epo: 14 | avg.loss:2.2387 | avg.acc:78.329 (curr:84.000): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.52it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 14 | avg.loss:2.2387 | avg.acc:78.329 (curr:84.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.38it/s]















[train] epo: 15 | avg.loss:2.2207 | avg.acc:78.311 (curr:82.667):  99%|████████████████████████████████████▌| 74/75 [00:30<00:00,  2.54it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 15 | avg.loss:2.2207 | avg.acc:78.311 (curr:82.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]















[train] epo: 16 | avg.loss:2.1670 | avg.acc:78.951 (curr:82.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.54it/s]
[ log ] *********A better model is found (78.951) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 16 | avg.loss:2.1670 | avg.acc:78.951 (curr:82.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.38it/s]















[train] epo: 17 | avg.loss:2.0801 | avg.acc:79.964 (curr:92.000): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.54it/s]
[ log ] *********A better model is found (79.964) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 17 | avg.loss:2.0801 | avg.acc:79.964 (curr:92.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]















[train] epo: 18 | avg.loss:1.9993 | avg.acc:80.658 (curr:85.333): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]
[ log ] *********A better model is found (80.658) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.38 h left















[train] epo: 19 | avg.loss:1.9714 | avg.acc:81.440 (curr:74.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
[ log ] *********A better model is found (81.440) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.37 h left















[train] epo: 20 | avg.loss:1.8361 | avg.acc:83.129 (curr:89.333): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.54it/s]
[ log ] *********A better model is found (83.129) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.36 h left















[train] epo: 21 | avg.loss:1.8620 | avg.acc:81.600 (curr:72.000): 100%|█████████████████████████████████████| 75/75 [00:30<00:00,  2.53it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 21 | avg.loss:1.8620 | avg.acc:81.600 (curr:72.000): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.39it/s]















[train] epo: 22 | avg.loss:1.8434 | avg.acc:81.867 (curr:86.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.34 h left















[train] epo: 23 | avg.loss:1.7595 | avg.acc:84.444 (curr:89.333): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.41it/s]
[ log ] *********A better model is found (84.444) *********
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[ log ] roughly 0.33 h left














[train] epo: 24 | avg.loss:1.7033 | avg.acc:84.427 (curr:82.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.40it/s]
  0%|                                                                                                                | 0/75 [00:00<?, ?it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20















[train] epo: 25 | avg.loss:1.6744 | avg.acc:84.124 (curr:82.667):  99%|████████████████████████████████████▌| 74/75 [00:30<00:00,  2.53it/s]
[ log ] saving @ checkpoints/miniimagenet/5shot-5way/your_run_11_20
[train] epo: 25 | avg.loss:1.6744 | avg.acc:84.124 (curr:82.667): 100%|█████████████████████████████████████| 75/75 [00:31<00:00,  2.41it/s]


[train] epo: 26 | avg.loss:1.7194 | avg.acc:84.000 (curr:86.667):   9%|███▌                                  | 7/75 [00:05<00:55,  1.22it/s]
Traceback (most recent call last):
  File "/root/renet/train.py", line 145, in <module>
    model = train_main(args)
  File "/root/renet/train.py", line 113, in train_main
    train_loss, train_acc, _ = train(epoch, model, train_loaders, optimizer, args)
  File "/root/renet/train.py", line 70, in train
    torch.nn.utils.clip_grad_norm_(model.parameters(), 2.0)
  File "/root/miniconda3/envs/renet_iccv21/lib/python3.9/site-packages/torch/nn/utils/clip_grad.py", line 38, in clip_grad_norm_
    if clip_coef < 1:
KeyboardInterrupt